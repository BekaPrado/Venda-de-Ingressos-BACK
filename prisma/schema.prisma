generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model tbl_admin_login {
  id    Int    @id
  email String @unique(map: "email") @db.VarChar(255)
  senha String @db.VarChar(100)
}

model tbl_categoria {
  id         Int          @id @default(autoincrement())
  nome       String       @unique(map: "nome") @db.VarChar(100)
  tbl_evento tbl_evento[]
}

model tbl_cupom {
  id                   Int             @id @default(autoincrement())
  codigo               String          @db.VarChar(50)
  descricao            String?         @db.VarChar(150)
  desconto             Decimal?        @db.Decimal(10, 2)
  tipo                 tbl_cupom_tipo? @default(percentual)
  botao_pagseguro_html String          @db.Text
  evento_id            Int
  valido_ate           DateTime?       @db.Date
  criado_em            DateTime?       @default(now()) @db.Timestamp(0)
  tbl_evento           tbl_evento      @relation(fields: [evento_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "tbl_cupom_ibfk_1")
  tbl_empresa          tbl_empresa[]

  @@index([evento_id], map: "evento_id")
}

model tbl_empresa {
  id               Int                @id @default(autoincrement())
  nome_empresa     String             @db.VarChar(150)
  email            String             @db.VarChar(150)
  telefone         String?            @db.VarChar(20)
  cpf              String?            @db.VarChar(14)
  cnpj             String?            @db.VarChar(18)
  endereco         String?            @db.VarChar(255)
  evento_id        Int
  cupom_id         Int?
  criado_em        DateTime?          @default(now()) @db.Timestamp(0)
  tbl_evento       tbl_evento         @relation(fields: [evento_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "tbl_empresa_ibfk_1")
  tbl_cupom        tbl_cupom?         @relation(fields: [cupom_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "tbl_empresa_ibfk_2")
  tbl_participante tbl_participante[]

  @@index([cupom_id], map: "cupom_id")
  @@index([evento_id], map: "evento_id")
}

model tbl_evento {
  id                   Int                @id @default(autoincrement())
  nome                 String             @db.VarChar(150)
  descricao            String             @db.Text
  valor                Decimal            @db.Decimal(10, 2)
  foto_url             String?            @db.VarChar(255)
  categoria_id         Int
  data_evento          DateTime           @db.Date
  horario_evento       DateTime           @db.Time(0)
  botao_pagseguro      String?            @db.Text
  status               tbl_evento_status? @default(ativo)
  criado_em            DateTime?          @default(now()) @db.Timestamp(0)
  limite_participantes Int                @default(1)
  tbl_cupom            tbl_cupom[]
  tbl_empresa          tbl_empresa[]
  tbl_categoria        tbl_categoria      @relation(fields: [categoria_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "tbl_evento_ibfk_1")

  @@index([categoria_id], map: "categoria_id")
}

model tbl_participante {
  id          Int         @id @default(autoincrement())
  nome        String      @db.VarChar(150)
  email       String?     @db.VarChar(150)
  telefone    String?     @db.VarChar(20)
  empresa_id  Int
  tbl_empresa tbl_empresa @relation(fields: [empresa_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "tbl_participante_ibfk_1")

  @@index([empresa_id], map: "empresa_id")
}

enum tbl_cupom_tipo {
  percentual
  valor
}

enum tbl_evento_status {
  ativo
  cancelado
  excluido
}
